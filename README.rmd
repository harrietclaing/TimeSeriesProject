---
output:
  md_document:
    variant: markdown_github
---

# Purpose
To replicate the study by Cologni & Manera to find the economic impact of a rise in oil prices.

```{r}
rm(list = ls()) # Clean your environment:
gc() # garbage collection - It can be useful to call gc after a large object has been removed, as this may prompt R to return memory to the operating system.
library(tidyverse)
library(zoo)
library(tseries)
library(vars)
```
# Step 1: Find the data

Tried to find all data from the IMF, but for Exchange Rates had to use OECD estimates and for Inflation had to use US Bureau of Labor Statistics.

First, we want to use US data and see if we can replicate the results in the study. We need to convert all the data into quarterly and limit the time period to the one used in the paper which is from 1980Q1 to 2003Q3. 

Interest rates ($r_t$)
```{r}
#rename column in dataframe
InterestRateUS_ <- rename(InterestRateUS, InterestRate=INTDSRUSM193N)

#convert monthly to quarterly

InterestRates_US <- InterestRateUS_ %>% 
    group_by(DATE = format(as.yearqtr(DATE, "%b-%Y"), "%YQ%q")) %>%
    summarise_all(mean) %>% 
    filter(DATE>"1979Q4" & DATE<"2003Q4")
#we want to filter to get the correct time frame
InterestRates_US
```
Inflation ($p_t$)
```{r}
#rename column in dataframe
InflationUS_ <- rename(InflationUSBLSUS, Inflation=CPIAUCSL)

#convert monthly to quarterly

Inflation_US <- InflationUS_ %>% 
    group_by(DATE = format(as.yearqtr(DATE, "%b-%Y"), "%YQ%q")) %>%
    summarise_all(mean) %>% 
    filter(DATE>"1979Q4" & DATE<"2003Q4")
#we want to filter to get the correct time frame
Inflation_US
```


Monetary aggregates ($M_t$)
```{r}
#rename column in dataframe
MonetaryAggregateM1US_ <- rename(MonetaryAggregateM1US, MonetaryAggregate=MYAGM1USM052S)

#convert monthly to quarterly

MonetaryAggregateM1_US <- MonetaryAggregateM1US_ %>% 
    group_by(DATE = format(as.yearqtr(DATE, "%b-%Y"), "%YQ%q")) %>%
    summarise_all(mean) %>% 
    filter(DATE>"1979Q4" & DATE<"2003Q4")
#we want to filter to get the correct time frame
MonetaryAggregateM1_US
```



Exchange rates ($e_t$)
```{r}
#rename column in dataframe
ExchangeRatesOECDUS_ <- rename(ExchangeRatesOECDUS, ExchangeRate=CCUSSP01IFM650N)

#convert monthly to quarterly

ExchangeRates_US <- ExchangeRatesOECDUS_ %>% 
    group_by(DATE = format(as.yearqtr(DATE, "%b-%Y"), "%YQ%q")) %>%
    summarise_all(mean) %>% 
    filter(DATE>"1979Q4" & DATE<"2003Q4")
#we want to filter to get the correct time frame
ExchangeRates_US
```
For real GDP, we have quarterly, so we will need to simply isolate the time period.
```{r}
#rename column in dataframe
RealGDPUS_ <- rename(RealGDPUS, RealGDP=NGDPRSAXDCUSQ)

RealGDP_US <- RealGDPUS_ %>% 
                group_by(DATE = format(as.yearqtr(DATE, "%b-%Y"), "%YQ%q")) %>%
                filter(DATE>"1979Q4" & DATE<"2003Q4")
#we want to filter to get the correct time frame
RealGDP_US
```

# Step 2: Transform the data 

Next step is to transform all variables in logs, except for the interest rate.

```{r}
logInflation_US <- data.frame(DATE=Inflation_US$DATE, logInflation=log(Inflation_US$Inflation))
logRealGDP_US <- data.frame(DATE=RealGDP_US$DATE, logRealGDP=log(RealGDP_US$RealGDP))
logMonetaryAggregateM1_US <-data.frame(DATE=MonetaryAggregateM1_US$DATE,logMonetaryAggregateM1=log(MonetaryAggregateM1_US$MonetaryAggregate))
logExchangeRates_US <-data.frame(DATE=ExchangeRates_US$DATE, logExchangeRates=log(ExchangeRates_US$ExchangeRate))
```


# Step 3: Augemented Dickey-Fuller tests

The null-hypothesis of an Augmented Dickey-Fuller test is that the series has a unit-root. We ask, is the estimated critical value small enough to reject the null-hypothesis? If yes, we cannot reject the null hypothesis, therefore, the series may be non-stationary.

Interest Rate
```{r}
#let us visualise first
ggplot() +
    geom_point(aes(InterestRates_US$DATE, InterestRates_US$InterestRate))

adf.InterestRate <- ur.df(InterestRates_US$InterestRate, type = "none", selectlags = c("AIC"))
summary(adf.InterestRate)
```
The estimated critical value of -2.0189 is not small enough to reject the null hypothesis at any confidence interval, ie -2.0189 > -2.6

Inflation
```{r}
ggplot() +
    geom_point(aes(logInflation_US$DATE, logInflation_US$logInflation))

adf.Inflation <- ur.df(Inflation_US$Inflation, type = "none", selectlags = c("AIC"))
summary(adf.Inflation)
```
The estimated critical value of 4.7033 is not small enough to reject the null hypothesis, 4.7033 > -2.6. Therefore cannot reject the null hypothesis that there is a unit root.

Real GDP
```{r}
ggplot() +
    geom_point(aes(logRealGDP_US$DATE, logRealGDP_US$logRealGDP))

adf.RealGDP <- ur.df(logRealGDP_US$logRealGDP, type = "none", selectlags = c("AIC"))
summary(adf.RealGDP)
```
The estimated critical value is not small enough to reject the null hypothesis of a unit root, 5.6119 > -2.6.

Monetary Aggregates
```{r}
ggplot() +
    geom_point(aes(logMonetaryAggregateM1_US$DATE, logMonetaryAggregateM1_US$logMonetaryAggregateM1))

adf.MonetaryAggregate <- ur.df(logMonetaryAggregateM1_US$logMonetaryAggregateM1, type = "none", selectlags = c("AIC"))
summary(adf.MonetaryAggregate)
```
2.9491 > -2.6 therefore cannot reject the null hypothesis of unit root

Exchange Rate
```{r}
ggplot() +
    geom_point(aes(logExchangeRates_US$DATE, logExchangeRates_US$logExchangeRates))

adf.ExchangeRates <- ur.df(logExchangeRates_US$logExchangeRates, type = "none", selectlags = c("AIC"))
summary(adf.ExchangeRates)
```
CONCERING BECAUSE WE FIND THAT WE CAN REJECT THE NULL HYPOTHESIS FOR EXCHANGE RATES

According to the paper, they decided to deal with I(2) processes of Monetary Aggregates and Inflation with considering real money aggregate $m_t - p_t$ and inflation rate as change in $p_t$

# Step 4: Johansen Test in the Long-Run Approach

# Step 5: AIC criteria to choose lags

